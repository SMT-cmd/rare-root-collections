<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RARE ROOT | Prestige</title>
    <meta name="description" content="RARE ROOT — premium Nigerian streetwear. Prestige in every thread. Explore collections, preorder, and track orders.">
    <meta property="og:title" content="RARE ROOT — Prestige Streetwear">
    <meta property="og:description" content="High-performance apparel for the disciplined. Explore The Exchange, Kinetic, and Urban Archive.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://files.fm/thumb.php?i=y628qspy4s">
    <meta property="og:url" content="https://yourdomain.example/">
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>

    <style>
/* -------------------------------------------------------
   THEME: PRESTIGE STREETWEAR (Wine, Gold, Dark)
   ------------------------------------------------------- */
:root {
    --bg-dark: #2b1f1a;
    --bg-wine: #3a2a22;
    --bg-card: rgba(255, 255, 255, 0.05);
    --text-gold: #d8a35d;
    --text-cream: #efe6d9;
    --accent-red: #b23a3a;
    --glass: rgba(58, 42, 34, 0.7);
    --glass-border: rgba(255, 255, 255, 0.1);
    --font-head: 'Cinzel', serif;
    --font-body: 'Inter', sans-serif;
}

* {
    box-sizing: border-box;
}

.glass-card {
    background: var(--bg-card);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
}

.glass-drawer {
    background: rgba(42, 32, 26, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-left: 1px solid var(--glass-border);
}

html {
    scroll-behavior: smooth;
}

body {
    margin: 0;
    padding: 0;
    font-family: var(--font-body);
    background-color: var(--bg-dark);
    background-image:
        radial-gradient(1200px 800px at 20% 10%, rgba(216, 163, 93, 0.08), transparent 70%),
        radial-gradient(900px 600px at 80% 30%, rgba(216, 163, 93, 0.06), transparent 70%),
        url("https://www.transparenttextures.com/patterns/white-linen.png");
    background-blend-mode: normal, normal, multiply;
    background-size: auto, auto, 300px 300px;
    color: var(--text-cream);
    overflow-x: hidden;
    line-height: 1.6;
    min-height: 100vh;
    width: 100%;
}

/* -------------------------------------------------------
   ANIMATIONS
   ------------------------------------------------------- */
.reveal-on-scroll {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
}

.reveal-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
}

@keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0px); }
}

/* -------------------------------------------------------
   HEADER & MENU (MODERN GLASS) - FIXED SIZING
   ------------------------------------------------------- */
nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    width: 100%;
    z-index: 1000;
    background: rgba(58, 42, 34, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
    max-width: 100vw;
    box-sizing: border-box;
}

.menu-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #fff;
    width: 42px;
    height: 42px;
    border-radius: 10px;
    font-size: 1.1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.menu-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #ffc107;
}

.logo {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    padding: 0 15px;
}

.nav-logo-img {
    height: 50px;
    width: auto;
    max-width: 100%;
    display: block;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.nav-logo-img:hover {
    transform: scale(1.05);
}

.nav-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
}

.search-box {
    position: relative;
    display: flex;
    align-items: center;
}

.search-box input {
    width: 160px;
    padding: 10px 14px;
    background: rgba(0,0,0,0.3);
    border: 1px solid rgba(224, 192, 151, 0.2);
    border-radius: 8px;
    color: var(--text-cream);
    font-family: var(--font-body);
    font-size: 0.8rem;
    outline: none;
    transition: all 0.3s ease;
}

.search-box input:focus {
    border-color: var(--text-gold);
    width: 200px;
}

.search-box input::placeholder {
    color: rgba(244, 241, 234, 0.5);
}

.cart-icon {
    position: relative;
    background: rgba(255, 255, 255, 0.05);
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.1);
    flex-shrink: 0;
}

.cart-icon:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.cart-icon i {
    font-size: 1.1rem;
    color: var(--text-gold);
}

.cart-count {
    position: absolute;
    top: -6px;
    right: -6px;
    background: #ff4757;
    color: white;
    font-size: 0.65rem;
    font-weight: 800;
    width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    border: 2px solid var(--bg-dark);
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

/* -------------------------------------------------------
   HERO SECTION (PREMIUM)
   ------------------------------------------------------- */
.hero {
    position: relative;
    text-align: center;
    padding: 140px 20px 80px;
    background: radial-gradient(circle at center, rgba(108, 76, 55, 0.45) 0%, var(--bg-dark) 70%);
    overflow: hidden;
    width: 100%;
    max-width: 100vw;
    box-sizing: border-box;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23e0c097' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    opacity: 1;
    z-index: -1;
}

.hero-title {
    font-family: var(--font-head);
    font-size: clamp(2rem, 8vw, 3.2rem);
    color: var(--text-gold);
    margin: 0 0 15px;
    line-height: 1.1;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 0 10px 30px rgba(0,0,0,0.5);
    opacity: 0;
    animation: fadeInUp 1s forwards 0.2s;
}

.hero-subtitle {
    font-size: clamp(0.75rem, 2vw, 1rem);
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--text-cream);
    opacity: 0;
    font-weight: 300;
    margin-bottom: 30px;
    animation: fadeInUp 1s forwards 0.5s;
}

.btn-hero {
    background: transparent;
    border: 1px solid var(--text-gold);
    color: var(--text-gold);
    padding: 14px 32px;
    font-family: var(--font-body);
    font-size: 0.8rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    opacity: 0;
    animation: fadeInUp 1s forwards 0.8s;
    border-radius: 4px;
}

.btn-hero:hover {
    background: var(--text-gold);
    color: var(--bg-dark);
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(224, 192, 151, 0.1);
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(40px); }
    to { opacity: 1; transform: translateY(0); }
}

/* -------------------------------------------------------
   BRAND IDENTITY
   ------------------------------------------------------- */
.brand-identity {
    padding: 60px 20px;
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
    position: relative;
    width: 100%;
    box-sizing: border-box;
}

.brand-text {
    font-size: clamp(0.95rem, 2vw, 1.15rem);
    line-height: 1.8;
    color: var(--text-cream);
    opacity: 0.9;
    font-weight: 300;
}

.brand-text strong {
    color: var(--text-gold);
    font-weight: 600;
}

/* -------------------------------------------------------
   LAYOUT & GRID - FIXED MAX WIDTH
   ------------------------------------------------------- */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 15px;
    width: 100%;
    box-sizing: border-box;
}

.collection-header {
    margin: 60px 0 30px;
    text-align: center;
    position: relative;
}

.collection-header::after {
    content: '';
    display: block;
    width: 40px;
    height: 1px;
    background: var(--text-gold);
    margin: 12px auto 0;
    opacity: 0.5;
}

.category-title {
    font-family: var(--font-head);
    font-size: clamp(1.6rem, 4vw, 2.2rem);
    color: var(--text-gold);
    margin: 0;
    letter-spacing: 2px;
    font-weight: 400;
}

.category-subtitle {
    font-family: var(--font-body);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    opacity: 0.6;
    margin-top: 6px;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 16px;
    margin-bottom: 60px;
    width: 100%;
}

/* -------------------------------------------------------
   PRODUCT CARDS (GLASSMORPHISM)
   ------------------------------------------------------- */
.product-card {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 14px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    position: relative;
    padding: 10px;
}

.product-card:hover {
    transform: translateY(-6px);
    border-color: var(--text-gold);
    background: rgba(255, 255, 255, 0.06);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
}

.product-image-container {
    width: 100%;
    aspect-ratio: 1/1;
    height: auto;
    overflow: hidden;
    position: relative;
    background: #33251f;
    border-radius: 10px;
    margin-bottom: 10px;
}

.product-image-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
}

.product-card:hover .product-image-container img {
    transform: scale(1.05);
}

.discount-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    background: #ff4757;
    color: white;
    padding: 4px 8px;
    font-size: 0.6rem;
    font-weight: 800;
    border-radius: 6px;
    z-index: 2;
}
.stock-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(178, 58, 58, 0.9);
    color: white;
    padding: 4px 8px;
    font-size: 0.6rem;
    font-weight: 800;
    border-radius: 6px;
    z-index: 2;
}

.product-info {
    padding: 4px 2px;
}

.product-info h3 {
    font-family: var(--font-body);
    font-size: 0.8rem;
    color: #fff;
    margin: 0 0 5px 0;
    font-weight: 500;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.product-info .price {
    font-size: 1rem;
    color: var(--text-gold);
    font-weight: 700;
    font-family: var(--font-body);
    margin: 0;
}

.product-info .original-price {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.3);
    text-decoration: line-through;
    margin-right: 6px;
}

.view-options-btn {
    position: absolute;
    bottom: 15px;
    right: 15px;
    background: var(--text-gold);
    color: #000;
    padding: 8px 14px;
    border-radius: 8px;
    font-size: 0.75rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 6px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
}

.product-card:hover .view-options-btn {
    opacity: 1;
    transform: translateY(0);
}

.view-options-btn i {
    font-size: 0.8rem;
}

/* -------------------------------------------------------
   NEWSLETTER
   ------------------------------------------------------- */
.newsletter-section {
    background: linear-gradient(to bottom, var(--bg-dark), #110a09);
    padding: 80px 20px;
    text-align: center;
    border-top: 1px solid rgba(224, 192, 151, 0.05);
    width: 100%;
    box-sizing: border-box;
}

.newsletter-content h3 {
    font-family: var(--font-head);
    font-size: clamp(1.8rem, 4vw, 2.5rem);
    color: var(--text-gold);
    margin-bottom: 12px;
}

.newsletter-content p {
    color: rgba(244, 241, 234, 0.6);
    margin-bottom: 30px;
    font-size: 0.95rem;
}

.newsletter-form {
    display: flex;
    justify-content: center;
    gap: 0;
    max-width: 450px;
    margin: 0 auto;
    position: relative;
    flex-wrap: wrap;
}

.newsletter-form input {
    padding: 16px 20px;
    width: 100%;
    max-width: 300px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--text-cream);
    font-family: var(--font-body);
    font-size: 0.95rem;
    border-radius: 4px 0 0 4px;
    transition: border-color 0.3s;
    flex: 1;
}

.newsletter-form input:focus {
    outline: none;
    border-color: var(--text-gold);
}

.newsletter-form button {
    padding: 16px 24px;
    background: var(--text-gold);
    border: none;
    color: var(--bg-dark);
    font-weight: 700;
    text-transform: uppercase;
    cursor: pointer;
    border-radius: 0 4px 4px 0;
    transition: background 0.3s;
    font-size: 0.8rem;
    white-space: nowrap;
}

.newsletter-form button:hover {
    background: #fff;
}

/* -------------------------------------------------------
   FOOTER
   ------------------------------------------------------- */
footer {
    background: #110a09;
    padding: 60px 20px 25px;
    border-top: 1px solid rgba(224, 192, 151, 0.1);
    width: 100%;
    box-sizing: border-box;
}

.footer-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 40px;
    max-width: 1100px;
    margin: 0 auto;
}

.footer-logo {
    height: 60px;
    margin-bottom: 15px;
    opacity: 0.9;
}

.footer-col h4 {
    font-family: var(--font-head);
    color: var(--text-gold);
    margin-bottom: 20px;
    font-size: 1rem;
}

.footer-col a {
    display: block;
    color: rgba(244, 241, 234, 0.6);
    text-decoration: none;
    margin-bottom: 12px;
    font-size: 0.85rem;
    transition: color 0.3s, transform 0.3s;
}

.footer-col a:hover {
    color: var(--text-gold);
    transform: translateX(3px);
}

.footer-bottom {
    text-align: center;
    margin-top: 50px;
    padding-top: 25px;
    border-top: 1px solid rgba(255,255,255,0.03);
    font-size: 0.75rem;
    color: rgba(255,255,255,0.3);
}

/* -------------------------------------------------------
   DRAWER SYSTEM (Menu & Cart) - FIXED WIDTH
   ------------------------------------------------------- */
.menu-drawer, .cart-drawer {
    position: fixed;
    top: 0;
    height: 100vh;
    height: 100dvh;
    background: rgba(42, 32, 26, 0.98);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    z-index: 1001;
    transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    box-shadow: 0 0 50px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
}

.menu-drawer {
    left: 0;
    width: 300px;
    max-width: 85vw;
    transform: translateX(-100%);
    border-right: 1px solid var(--glass-border);
}

.cart-drawer {
    right: 0;
    width: 380px;
    max-width: 90vw;
    transform: translateX(100%);
    border-left: 1px solid var(--glass-border);
}

.menu-drawer.open, .cart-drawer.open {
    transform: translateX(0);
}

.menu-header, .cart-header {
    padding: 25px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}

.menu-title, .cart-title {
    font-family: var(--font-head);
    font-size: 1.3rem;
    color: var(--text-gold);
}
.cart-title img {
    height: 24px;
    filter: drop-shadow(0 0 8px rgba(224, 192, 151, 0.2));
}

.close-menu, .close-cart {
    background: none;
    border: none;
    color: var(--text-cream);
    font-size: 1.8rem;
    cursor: pointer;
    line-height: 1;
    transition: color 0.3s;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.close-menu:hover, .close-cart:hover {
    color: var(--text-gold);
    background: rgba(255,255,255,0.05);
}

.menu-links {
    list-style: none;
    padding: 30px 20px;
    margin: 0;
}

.menu-links li {
    margin-bottom: 20px;
    opacity: 0;
    transform: translateX(-20px);
    transition: all 0.4s ease;
}

.menu-drawer.open .menu-links li {
    opacity: 1;
    transform: translateX(0);
}

.menu-drawer.open .menu-links li:nth-child(1) { transition-delay: 0.1s; }
.menu-drawer.open .menu-links li:nth-child(2) { transition-delay: 0.15s; }
.menu-drawer.open .menu-links li:nth-child(3) { transition-delay: 0.2s; }
.menu-drawer.open .menu-links li:nth-child(4) { transition-delay: 0.25s; }
.menu-drawer.open .menu-links li:nth-child(5) { transition-delay: 0.3s; }
.menu-drawer.open .menu-links li:nth-child(6) { transition-delay: 0.35s; }

.menu-links a {
    color: var(--text-cream);
    text-decoration: none;
    font-size: 1.05rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    transition: color 0.3s, padding-left 0.3s;
    display: block;
    padding: 8px 0;
}

.menu-links a:hover {
    color: var(--text-gold);
    padding-left: 8px;
}

.cart-items {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    -webkit-overflow-scrolling: touch;
}
.empty-cart {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 40px 20px;
    text-align: center;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 16px;
    border: 1px solid var(--glass-border);
}
.empty-cart img {
    height: 70px;
    margin-bottom: 15px;
    opacity: 0.9;
}

.cart-item {
    display: flex;
    gap: 12px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    margin-bottom: 12px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.cart-item:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
}

.cart-item img {
    width: 65px;
    height: 65px;
    border-radius: 10px;
    object-fit: cover;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.cart-item-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 0;
}

.cart-item-name {
    font-family: var(--font-body);
    font-size: 0.85rem;
    color: #fff;
    margin-bottom: 3px;
    font-weight: 600;
    text-transform: uppercase;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.cart-item-meta {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.5);
    margin-bottom: 5px;
}

.cart-item-price {
    font-size: 0.95rem;
    color: var(--text-gold);
    font-weight: 700;
    margin-bottom: 6px;
}

.cart-item-qty {
    display: flex;
    align-items: center;
    gap: 10px;
}

.qty-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #fff;
    width: 26px;
    height: 26px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    transition: all 0.2s;
}

.qty-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.cart-item-remove {
    color: #ff4757;
    cursor: pointer;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    transition: all 0.2s;
}

.cart-item-remove:hover {
    background: rgba(255, 71, 87, 0.1);
}

.cart-footer {
    padding: 20px;
    background: rgba(10, 14, 20, 0.95);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.btn-checkout {
    width: 100%;
    padding: 16px;
    background: var(--text-gold);
    color: #000;
    border: none;
    border-radius: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 0.85rem;
}

.btn-checkout:hover {
    background: #fff;
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
}

.checkout-email {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 15px;
}
.checkout-email input {
    width: 100%;
    padding: 12px 14px;
    background: rgba(0,0,0,0.3);
    border: 1px solid rgba(224, 192, 151, 0.2);
    border-radius: 10px;
    color: var(--text-cream);
    font-family: var(--font-body);
    font-size: 0.9rem;
    outline: none;
    box-sizing: border-box;
}
.checkout-email input::placeholder {
    color: rgba(244, 241, 234, 0.5);
}

.total-price {
    display: flex;
    justify-content: space-between;
    font-family: var(--font-body);
    color: #fff;
    font-size: 1rem;
    margin-bottom: 18px;
    font-weight: 500;
}

.total-price span:last-child {
    color: var(--text-gold);
    font-weight: 700;
    font-size: 1.3rem;
}

.overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.75);
    backdrop-filter: blur(4px);
    z-index: 900;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s;
}

.overlay.active {
    opacity: 1;
    pointer-events: all;
}

/* -------------------------------------------------------
   TOAST NOTIFICATION
   ------------------------------------------------------- */
.toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--text-gold);
    color: var(--bg-dark);
    padding: 14px 28px;
    border-radius: 10px;
    font-family: var(--font-body);
    font-weight: 600;
    font-size: 0.9rem;
    z-index: 3000;
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

.toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* -------------------------------------------------------
   MODAL STYLING
   ------------------------------------------------------- */
.modal {
    display: none; 
    position: fixed; 
    z-index: 2000; 
    left: 0;
    top: 0;
    width: 100%; 
    height: 100%; 
    overflow: auto; 
    background-color: rgba(0,0,0,0.85); 
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

.modal-content {
    background: var(--bg-card);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    margin: 20px auto; 
    width: 95%; 
    max-width: 950px;
    max-height: 90vh;
    display: flex;
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    box-shadow: 0 40px 100px rgba(0,0,0,0.6);
    position: relative;
    animation: modalReveal 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
    overflow: hidden;
}

@keyframes modalReveal {
    from { opacity: 0; transform: translateY(30px) scale(0.95); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}

.close-modal {
    position: absolute;
    top: 15px;
    right: 20px;
    color: var(--text-gold);
    font-size: 2rem;
    cursor: pointer;
    z-index: 100;
    line-height: 1;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.4);
    transition: all 0.3s ease;
    border: none;
}

.close-modal:hover {
    background: var(--text-gold);
    color: var(--bg-dark);
}

.modal-body {
    display: flex;
    width: 100%;
    overflow: hidden;
}

.modal-left {
    flex: 1.1;
    background: rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    padding: 15px;
    overflow-y: auto;
}

.modal-img-container {
    position: relative;
    width: 100%;
    height: 400px;
    margin-bottom: 15px;
    border-radius: 14px;
    overflow: hidden;
    background: #000;
}

.modal-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity 0.5s ease;
}

.modal-thumbnails {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding: 8px 0;
    scrollbar-width: none;
}

.modal-thumbnails::-webkit-scrollbar { display: none; }

.thumb-img {
    width: 60px;
    height: 60px;
    border-radius: 10px;
    object-fit: cover;
    border: 2px solid transparent;
    cursor: pointer;
    opacity: 0.5;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.thumb-img.active {
    opacity: 1;
    border-color: var(--text-gold);
    transform: scale(1.05);
}

.modal-info {
    flex: 1;
    padding: 35px 30px;
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.02);
    overflow-y: auto;
}

.modal-info h2 {
    font-family: var(--font-head);
    font-size: 1.8rem;
    color: var(--text-gold);
    margin-bottom: 8px;
    letter-spacing: 1px;
}

.modal-price {
    font-size: 1.5rem;
    font-weight: 700;
    color: #fff;
    margin-bottom: 20px;
}

.modal-description {
    font-size: 0.95rem;
    line-height: 1.7;
    color: rgba(255,255,255,0.7);
    margin-bottom: 25px;
    border-bottom: 1px solid var(--glass-border);
    padding-bottom: 20px;
}

.modal-opt-group {
    margin-bottom: 18px;
}

.modal-opt-label {
    display: block;
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--text-gold);
    margin-bottom: 10px;
    opacity: 0.8;
}

.modal-select {
    width: 100%;
    padding: 12px 14px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--glass-border);
    color: var(--text-cream);
    font-family: var(--font-body);
    font-size: 0.9rem;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    outline: none;
}

.modal-select:focus {
    border-color: var(--text-gold);
    background: rgba(255, 255, 255, 0.1);
}

.btn-add-modal {
    width: 100%;
    padding: 16px;
    background: var(--text-gold);
    color: #000;
    border: none;
    border-radius: 14px;
    font-size: 0.9rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 15px;
}

.btn-add-modal:hover {
    background: #fff;
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
}

/* -------------------------------------------------------
   SIZE GUIDE MODAL
   ------------------------------------------------------- */
.size-guide-content {
    padding: 20px;
    max-width: 700px;
    margin: 0 auto;
}

.size-guide-content h2 {
    font-family: var(--font-head);
    color: var(--text-gold);
    text-align: center;
    margin-bottom: 25px;
    font-size: 1.6rem;
}

.size-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
    font-size: 0.9rem;
}

.size-table th,
.size-table td {
    padding: 12px 15px;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.1);
}

.size-table th {
    background: rgba(216, 163, 93, 0.15);
    color: var(--text-gold);
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.8rem;
    letter-spacing: 1px;
}

.size-table td {
    color: var(--text-cream);
}

.size-table tr:nth-child(even) {
    background: rgba(255,255,255,0.03);
}

.size-guide-note {
    background: rgba(216, 163, 93, 0.08);
    border: 1px solid rgba(216, 163, 93, 0.2);
    border-radius: 12px;
    padding: 18px;
    margin-top: 20px;
}

.size-guide-note h4 {
    color: var(--text-gold);
    margin: 0 0 10px 0;
    font-size: 1rem;
}

.size-guide-note p {
    color: rgba(255,255,255,0.7);
    margin: 0;
    font-size: 0.9rem;
    line-height: 1.6;
}

.size-guide-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
    flex-wrap: wrap;
}

.size-tab {
    padding: 10px 20px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--text-cream);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.85rem;
}

.size-tab.active,
.size-tab:hover {
    background: var(--text-gold);
    color: var(--bg-dark);
    border-color: var(--text-gold);
}

/* -------------------------------------------------------
   TRACK ORDER MODAL
   ------------------------------------------------------- */
#track-modal .modal-content {
    max-width: 500px;
}

#track-modal .modal-body {
    flex-direction: column;
    padding: 30px;
}

#track-modal h3 {
    margin-bottom: 10px;
    color: var(--text-gold);
    font-family: var(--font-head);
    font-size: 1.4rem;
}

#track-modal p {
    opacity: 0.7;
    font-size: 0.9rem;
    margin-bottom: 20px;
    color: var(--text-cream);
}

.track-inputs {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
    margin-bottom: 15px;
}

.track-inputs input {
    padding: 14px 16px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    color: var(--text-cream);
    font-family: var(--font-body);
    font-size: 0.95rem;
    outline: none;
}

.track-inputs input:focus {
    border-color: var(--text-gold);
}

.track-inputs input::placeholder {
    color: rgba(255,255,255,0.4);
}

/* -------------------------------------------------------
   PRESTIGE LOADER
   ------------------------------------------------------- */
#prestige-loader {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-dark);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: opacity 0.8s ease;
}

#prestige-loader img {
    height: 80px;
    margin-bottom: 20px;
    filter: drop-shadow(0 0 10px rgba(224, 192, 151, 0.2));
}

.loader-line {
    width: 40px;
    height: 1px;
    background: var(--text-gold);
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { width: 0; opacity: 0; }
    50% { width: 40px; opacity: 1; }
    100% { width: 0; opacity: 0; }
}

/* -------------------------------------------------------
   RESPONSIVE DESIGN - FIXED BREAKPOINTS
   ------------------------------------------------------- */
@media (max-width: 900px) {
    nav { padding: 10px 15px; }
    .nav-logo-img { height: 42px; }
    .search-box input { width: 130px; }
    .search-box input:focus { width: 160px; }
    
    .hero { padding: 120px 15px 60px; }
    .grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 12px; }
    
    .modal-content { 
        margin: 0; 
        width: 100%; 
        height: 100vh;
        height: 100dvh;
        max-width: none; 
        flex-direction: column; 
        overflow-y: auto; 
        border-radius: 0;
    }
    
    .modal-body { flex-direction: column; }
    .modal-left { height: 45vh; padding: 10px; }
    .modal-img-container { height: 100%; }
    .modal-info { padding: 25px 20px; }
    .modal-info h2 { font-size: 1.5rem; }
    .modal-price { font-size: 1.3rem; }
    
    .footer-content { 
        grid-template-columns: 1fr 1fr; 
        gap: 30px; 
    }
    .brand-col { grid-column: 1 / -1; text-align: center; }
}

@media (max-width: 600px) {
    nav { padding: 10px 12px; }
    .nav-logo-img { height: 38px; }
    .menu-btn { width: 38px; height: 38px; font-size: 1rem; }
    .cart-icon { width: 38px; height: 38px; }
    .search-box { display: none; }
    
    .hero { padding: 100px 12px 50px; }
    .hero-title { font-size: 2rem; }
    .hero-subtitle { font-size: 0.7rem; letter-spacing: 2px; }
    
    .collection-header { margin: 40px 0 20px; }
    .category-title { font-size: 1.4rem; }
    
    .grid { 
        grid-template-columns: repeat(2, 1fr); 
        gap: 10px; 
    }
    
    .product-card { padding: 8px; }
    .product-image-container { border-radius: 8px; margin-bottom: 8px; }
    .product-info h3 { font-size: 0.75rem; }
    .product-info .price { font-size: 0.9rem; }
    
    .view-options-btn { 
        opacity: 1; 
        transform: translateY(0); 
        padding: 6px 10px;
        font-size: 0.7rem;
        bottom: 10px;
        right: 10px;
    }
    
    .menu-drawer, .cart-drawer { 
        width: 100%; 
        max-width: 100%; 
    }
    
    .cart-drawer { max-width: 95vw; }
    
    .footer-content { 
        grid-template-columns: 1fr; 
        text-align: center; 
        gap: 30px; 
    }
    
    .newsletter-form { flex-direction: column; align-items: center; }
    .newsletter-form input { 
        border-radius: 4px; 
        max-width: 100%;
        margin-bottom: 10px;
    }
    .newsletter-form button { 
        border-radius: 4px; 
        width: 100%;
        max-width: 300px;
    }
    
    .size-table { font-size: 0.8rem; }
    .size-table th, .size-table td { padding: 8px 10px; }
}

@media (max-width: 380px) {
    .grid { grid-template-columns: repeat(2, 1fr); gap: 8px; }
    .product-info h3 { font-size: 0.7rem; }
    .product-info .price { font-size: 0.85rem; }
}

/* Hide scrollbar but keep functionality */
body::-webkit-scrollbar {
    width: 6px;
}

body::-webkit-scrollbar-track {
    background: var(--bg-dark);
}

body::-webkit-scrollbar-thumb {
    background: rgba(216, 163, 93, 0.3);
    border-radius: 3px;
}

body::-webkit-scrollbar-thumb:hover {
    background: rgba(216, 163, 93, 0.5);
}
    </style>
    <!-- Favicon -->
    <link rel="icon" href="https://files.fm/thumb.php?i=y628qspy4s" type="image/jpeg">
    
    <script src="https://js.paystack.co/v1/inline.js"></script>
<base target="_blank">
</head>
<body>

    <nav>
        <button class="menu-btn" onclick="toggleMenu()" aria-label="Open menu">
            <i class="fas fa-bars"></i>
        </button>
        <a href="#" class="logo" onclick="goToHome()">
            <img src="https://files.fm/thumb.php?i=4wunrd26s5" alt="RARE ROOT" class="nav-logo-img">
        </a>
        <div class="nav-actions">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Search..." onkeyup="handleSearch(this.value)">
            </div>
            <div class="cart-icon" onclick="toggleCart()" aria-label="Open cart">
                <i class="fas fa-shopping-cart"></i>
                <span id="cart-count" class="cart-count">0</span>
            </div>
        </div>
    </nav>

    <header class="hero" id="home">
        <h1 class="hero-title">RARE ROOT</h1>
        <p class="hero-subtitle">Prestige in Every Thread</p>
        <button class="btn-hero" onclick="document.getElementById('exchange-grid').scrollIntoView({behavior: 'smooth'})">Explore the Collection</button>
    </header>

    <!-- Brand Identity Section -->
    <section class="brand-identity">
        <p class="brand-text">
            <strong>RARE ROOT</strong> is a premium streetwear collective designed for the disciplined. 
            Rooted in Nigeria and serving the global hustle, we provide the high-performance uniform for those who move in silence. 
            Analyzing charts during a late-night trading session or pushing past your limits at the gym, our apparel represents your dedication to the grind.
        </p>
    </section>

    <div class="container">
        <div class="collection-header">
            <h2 class="category-title">THE EXCHANGE</h2>
            <p class="category-subtitle">Calculated Moves. Legacy Built.</p>
        </div>
        <div class="grid" id="exchange-grid"></div>

        <div class="collection-header">
            <h2 class="category-title">KINETIC</h2>
            <p class="category-subtitle">Form Meets Function. The Street Performance Line.</p>
        </div>
        <div class="grid" id="kinetic-grid"></div>

        <div class="collection-header">
            <h2 class="category-title">URBAN ARCHIVE</h2>
            <p class="category-subtitle">The Signature Street Silhouettes.</p>
        </div>
        <div class="grid" id="urban-grid"></div>
    </div>

    <!-- Newsletter Section -->
    <div class="newsletter-section">
        <div class="newsletter-content">
            <h3>Join The Inner Circle</h3>
            <p>Exclusive drops, early access, and insider trading.</p>
            <form class="newsletter-form" onsubmit="event.preventDefault(); showToast('Welcome to the inner circle!');">
                <input type="email" placeholder="Enter your email" required>
                <button type="submit">Subscribe</button>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer" id="footer">
        <div class="footer-content">
            <div class="footer-col brand-col">
                <img src="https://files.fm/thumb.php?i=y628qspy4s" alt="RARE ROOT" class="footer-logo">
                <p style="color: rgba(244, 241, 234, 0.6); font-size: 0.9rem;">Prestige in every thread.</p>
            </div>
            <div class="footer-col">
                <h4>Shop</h4>
                <a href="#exchange-grid">The Exchange</a>
                <a href="#kinetic-grid">Kinetic</a>
                <a href="#urban-grid">Urban Archive</a>
            </div>
            <div class="footer-col">
                <h4>Support</h4>
                <a href="#" onclick="openShippingModal(); return false;">Shipping & Returns</a>
                <a href="#" onclick="openSizeGuide(); return false;">Size Guide</a>
                <a href="#footer">Contact Us</a>
            </div>
            <div class="footer-col">
                <h4>Stay Connected</h4>
                <div class="social-links">
                    <a href="#" onclick="showToast('Instagram link coming soon'); return false;">Instagram</a>
                    <a href="#" onclick="showToast('Twitter link coming soon'); return false;">Twitter</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 RARE ROOT. All rights reserved.</p>
        </div>
    </footer>

    <div class="overlay" id="overlay" onclick="closeAllDrawers()"></div>

    <!-- Mobile Menu Drawer -->
    <div class="menu-drawer" id="menu-drawer">
        <div class="menu-header">
            <span class="menu-title">Menu</span>
            <button class="close-menu" onclick="toggleMenu()" aria-label="Close menu">&times;</button>
        </div>
        <ul class="menu-links">
            <li><a href="#home" onclick="toggleMenu()">Home</a></li>
            <li><a href="#exchange-grid" onclick="toggleMenu()">The Exchange</a></li>
            <li><a href="#kinetic-grid" onclick="toggleMenu()">Kinetic</a></li>
            <li><a href="#urban-grid" onclick="toggleMenu()">Urban Archive</a></li>
            <li><a href="#footer" onclick="toggleMenu()">Contact</a></li>
            <li><a href="#" onclick="openTrackModal(); toggleMenu(); return false;">Track Order</a></li>
        </ul>
    </div>

    <!-- Cart Drawer -->
    <div class="cart-drawer" id="cart-drawer">
        <div class="cart-header">
            <span class="cart-title"><img src="https://files.fm/thumb.php?i=4wunrd26s5" alt="RARE ROOT"></span>
            <button class="close-cart" onclick="toggleCart()" aria-label="Close cart">&times;</button>
        </div>
        <div class="cart-items" id="cart-items">
            <!-- Items injected by JS -->
        </div>
        <div class="cart-footer">
            <div class="total-price">
                <span>Total</span>
                <span id="cart-total">₦0</span>
            </div>
            <div class="checkout-email">
                <input type="email" id="checkout-email" placeholder="Email for receipt">
            </div>
            <button class="btn-checkout" onclick="checkoutPaystack()">
                <i class="fas fa-credit-card"></i> SECURE CHECKOUT
            </button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Notification</div>

    <!-- Prestige Loader -->
    <div id="prestige-loader">
        <img src="https://files.fm/thumb.php?i=y628qspy4s" alt="RARE ROOT">
        <div class="loader-line"></div>
    </div>

    <!-- Product Details Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()" aria-label="Close product details">&times;</button>
            <div class="modal-body" id="modal-body">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <!-- Track Order Modal -->
    <div id="track-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeTrackModal()" aria-label="Close track order">&times;</button>
            <div class="modal-body">
                <h3>Track Your Order</h3>
                <p>Enter your tracking code or order reference (RR-...).</p>
                <div class="track-inputs">
                    <input type="text" id="track-code" placeholder="Tracking Code">
                    <input type="text" id="track-ref" placeholder="Order Reference (RR-...)">
                </div>
                <button class="btn-checkout" onclick="findOrder()">Find Order</button>
                <div id="track-result" style="margin-top:15px;"></div>
            </div>
        </div>
    </div>

    <!-- Size Guide Modal -->
    <div id="size-guide-modal" class="modal">
        <div class="modal-content" style="max-width: 750px;">
            <button class="close-modal" onclick="closeSizeGuide()" aria-label="Close size guide">&times;</button>
            <div class="size-guide-content">
                <h2>Size Guide</h2>
                
                <div class="size-guide-tabs">
                    <button class="size-tab active" onclick="showSizeTab('tops')">Tops & T-Shirts</button>
                    <button class="size-tab" onclick="showSizeTab('bottoms')">Bottoms & Shorts</button>
                    <button class="size-tab" onclick="showSizeTab('accessories')">Accessories</button>
                </div>
                
                <div id="size-tops" class="size-tab-content">
                    <table class="size-table">
                        <thead>
                            <tr>
                                <th>Size</th>
                                <th>Chest (cm)</th>
                                <th>Chest (in)</th>
                                <th>Length (cm)</th>
                                <th>Length (in)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>XS</td><td>86-91</td><td>34-36</td><td>66</td><td>26</td></tr>
                            <tr><td>S</td><td>92-97</td><td>36-38</td><td>69</td><td>27</td></tr>
                            <tr><td>M</td><td>98-103</td><td>38-40</td><td>72</td><td>28</td></tr>
                            <tr><td>L</td><td>104-109</td><td>41-43</td><td>75</td><td>29.5</td></tr>
                            <tr><td>XL</td><td>110-115</td><td>43-45</td><td>78</td><td>31</td></tr>
                            <tr><td>XXL</td><td>116-121</td><td>46-48</td><td>81</td><td>32</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="size-bottoms" class="size-tab-content" style="display: none;">
                    <table class="size-table">
                        <thead>
                            <tr>
                                <th>Size</th>
                                <th>Waist (cm)</th>
                                <th>Waist (in)</th>
                                <th>Hip (cm)</th>
                                <th>Hip (in)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>XS</td><td>71-76</td><td>28-30</td><td>86-91</td><td>34-36</td></tr>
                            <tr><td>S</td><td>76-81</td><td>30-32</td><td>91-96</td><td>36-38</td></tr>
                            <tr><td>M</td><td>81-86</td><td>32-34</td><td>96-101</td><td>38-40</td></tr>
                            <tr><td>L</td><td>86-91</td><td>34-36</td><td>101-106</td><td>40-42</td></tr>
                            <tr><td>XL</td><td>91-96</td><td>36-38</td><td>106-111</td><td>42-44</td></tr>
                            <tr><td>XXL</td><td>96-101</td><td>38-40</td><td>111-116</td><td>44-46</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="size-accessories" class="size-tab-content" style="display: none;">
                    <table class="size-table">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Size</th>
                                <th>Measurement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Caps</td><td>One Size</td><td>Adjustable (56-60cm)</td></tr>
                            <tr><td>Beanies</td><td>One Size</td><td>Stretch fit</td></tr>
                            <tr><td>Bags</td><td>Standard</td><td>40cm x 30cm x 12cm</td></tr>
                            <tr><td>Socks</td><td>S/M/L</td><td>EU 38-41 / 42-45 / 46-49</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="size-guide-note">
                    <h4><i class="fas fa-ruler"></i> How to Measure</h4>
                    <p><strong>Chest:</strong> Measure around the fullest part of your chest, keeping the tape horizontal.<br>
                    <strong>Waist:</strong> Measure around your natural waistline, keeping the tape comfortably loose.<br>
                    <strong>Hip:</strong> Measure around the fullest part of your hips.<br><br>
                    All measurements are garment dimensions. For a relaxed fit, consider sizing up.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Shipping & Returns Modal -->
    <div id="shipping-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="close-modal" onclick="closeShippingModal()" aria-label="Close shipping info">&times;</button>
            <div class="modal-body" style="flex-direction: column; padding: 35px;">
                <h2 style="font-family: var(--font-head); color: var(--text-gold); margin-bottom: 25px; text-align: center;">Shipping & Returns</h2>
                
                <div style="margin-bottom: 25px;">
                    <h4 style="color: var(--text-gold); margin-bottom: 10px;"><i class="fas fa-truck"></i> Shipping</h4>
                    <p style="color: rgba(255,255,255,0.7); line-height: 1.7; font-size: 0.95rem;">
                        • <strong>Standard Delivery:</strong> 3-5 business days (Lagos), 5-7 business days (Nigeria)<br>
                        • <strong>Express Delivery:</strong> 1-2 business days (Lagos only)<br>
                        • <strong>International:</strong> 7-14 business days<br>
                        • Free shipping on orders over ₦50,000
                    </p>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <h4 style="color: var(--text-gold); margin-bottom: 10px;"><i class="fas fa-undo"></i> Returns</h4>
                    <p style="color: rgba(255,255,255,0.7); line-height: 1.7; font-size: 0.95rem;">
                        • Items can be returned within 14 days of delivery<br>
                        • Items must be unworn, unwashed, with original tags attached<br>
                        • Sale items are final sale and cannot be returned<br>
                        • Return shipping costs are the customer's responsibility
                    </p>
                </div>
                
                <div>
                    <h4 style="color: var(--text-gold); margin-bottom: 10px;"><i class="fas fa-envelope"></i> Need Help?</h4>
                    <p style="color: rgba(255,255,255,0.7); line-height: 1.7; font-size: 0.95rem;">
                        Contact us at <a href="mailto:support@rareroot.com" style="color: var(--text-gold);">support@rareroot.com</a> for any shipping or return inquiries.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
// ------------------------------------------------
// 1. DATABASE & STATE
// ------------------------------------------------
let products = [];
let cart = [];
let currentModalProduct = null;
let db;
let currentSizeTab = 'tops';

const PAYSTACK_PUBLIC_KEY = 'pk_test_74a74bdf05a89708936bc958ca3ddadf8ab3b3ef'; 

// Navigation History State
let navigationHistory = [];
let isNavigatingBack = false;

function saveCart() {
    try { localStorage.setItem('rr_cart', JSON.stringify(cart)); } catch (e) {}
}

function loadCart() {
    try { 
        const s = localStorage.getItem('rr_cart'); 
        if (s) { cart = JSON.parse(s) || []; updateCartUI(); }
    } catch (e) {}
}

// Firebase Configuration
const FIREBASE_CONFIG = { 
    apiKey: "AIzaSyDUemRdj8Q65vuid8ePqliNdrUmCBQjAiQ", 
    authDomain: "rare-root.firebaseapp.com", 
    projectId: "rare-root", 
    storageBucket: "rare-root.firebasestorage.app", 
    messagingSenderId: "555337627727", 
    appId: "1:555337627727:web:1e642ad1cbb5f2d6b7523a", 
    measurementId: "G-4QG0W6KZMN" 
};

function initFirebase() {
    if (!firebase.apps.length) {
        firebase.initializeApp(FIREBASE_CONFIG);
        if (typeof firebase.analytics === 'function') {
            firebase.analytics();
        }
    }
    db = firebase.firestore();
}

// Fetch Products from Firebase Firestore
async function fetchProducts() {
    try {
        initFirebase();
        
        const snapshot = await db.collection('products').get();
        products = snapshot.docs.map(doc => ({
            id: doc.id,
            ...doc.data()
        }));

        console.log('Loaded products from Firebase:', products.length);
        initializeShop();
        hideLoader();
    } catch (error) {
        console.error('Error loading products from Firebase:', error);
        
        // Fallback to local JSON if Firebase fails
        try {
            const response = await fetch('data/products.json');
            const data = await response.json();
            products = data.products || [];
            initializeShop();
            hideLoader();
        } catch (e) {
            showToast('Error loading shop inventory.');
            hideLoader();
        }
    }
}

function hideLoader() {
    const loader = document.getElementById('prestige-loader');
    if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.style.display = 'none', 800);
    }
}

function initializeShop() {
    renderCategory("The Exchange", "exchange-grid");
    renderCategory("Kinetic", "kinetic-grid");
    renderCategory("Urban Archive", "urban-grid");
}

// ------------------------------------------------
// 2. RENDERING
// ------------------------------------------------
function renderCategory(categoryName, elementId) {
    const container = document.getElementById(elementId);
    if (!container) return; 
    
    const items = products.filter(p => ((p.category || '').toLowerCase().trim() === categoryName.toLowerCase().trim()) && !p.hidden);
    
    if (items.length === 0) {
        container.innerHTML = '<p style="grid-column: 1/-1; text-align:center; opacity:0.5; padding: 40px;">Coming Soon</p>';
        return;
    }

    container.innerHTML = '';
    
    items.forEach(product => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.onclick = () => openProductModal(product.id);
        
        const isSale = product.sale_price && product.sale_price < product.price;
        const priceDisplay = isSale 
            ? `<span class="original-price">₦${product.price.toLocaleString()}</span> <span class="price">₦${product.sale_price.toLocaleString()}</span>` 
            : `<span class="price">₦${product.price.toLocaleString()}</span>`;
        
        const discountBadge = isSale 
            ? `<span class="discount-badge">-${Math.round(((product.price - product.sale_price) / product.price) * 100)}%</span>` 
            : '';
        const stockBadge = (product.stock && product.stock.toLowerCase() === 'out of stock') 
            ? `<span class="stock-badge">OUT OF STOCK</span>` 
            : '';

        card.innerHTML = `
            <div class="product-image-container">
                ${discountBadge}${stockBadge}
                <img src="${product.img}" alt="${product.name}" loading="lazy">
                <button class="view-options-btn">
                    <i class="fas fa-shopping-cart"></i> VIEW OPTIONS
                </button>
            </div>
            <div class="product-info">
                <h3>${product.name}</h3>
                ${priceDisplay}
            </div>
        `;
        container.appendChild(card);
    });
}

// ------------------------------------------------
// 3. PRODUCT MODAL & SELECTION
// ------------------------------------------------
function openProductModal(id) {
    const product = products.find(p => p.id === id);
    if (!product) return;

    currentModalProduct = product;
    const modal = document.getElementById('product-modal');
    const modalBody = document.getElementById('modal-body');

    // Push state for back button support
    pushModalState('product');

    let priceDisplay = `₦${product.price.toLocaleString()}`;
    let actualPrice = product.price;
    if (product.sale_price) {
        priceDisplay = `<span class="original-price" style="font-size: 1rem; color: rgba(255,255,255,0.4);">₦${product.price.toLocaleString()}</span> ₦${product.sale_price.toLocaleString()}`;
        actualPrice = product.sale_price;
    }
    const isOut = (product.stock || '').toLowerCase() === 'out of stock';

    let sizeOptions = product.sizes ? product.sizes.map(s => `<option value="${s}">${s}</option>`).join('') : '<option>One Size</option>';
    
    let variants = product.variants || [];
    if (variants.length === 0 && product.colors) {
        variants = product.colors.map(c => ({
            color: c.color,
            image: product.img
        }));
    }
    if (variants.length === 0) {
        variants = [{color: 'Standard', image: product.img}];
    }

    const colorOptions = variants.map(v => 
        `<option value="${v.color}" data-img="${v.image}">${v.color}</option>`
    ).join('');

    let thumbnailsHtml = '';
    if (variants.length > 1) {
        thumbnailsHtml = `
            <div class="modal-thumbnails">
                ${variants.map((v, index) => `
                    <img src="${v.image}" 
                         alt="${v.color}" 
                         onclick="updateModalImage('${v.image}', '${v.color}', this)"
                         class="thumb-img ${index === 0 ? 'active' : ''}">
                `).join('')}
            </div>`;
    }

    const initialImg = variants[0].image || product.img;

    modalBody.innerHTML = `
        <div class="modal-left">
            <div class="modal-img-container" id="modal-swipe-container">
                <img src="${initialImg}" alt="${product.name}" class="modal-img" id="modal-main-img">
            </div>
            ${thumbnailsHtml}
        </div>
        <div class="modal-info">
            <div style="margin-bottom: 5px; opacity: 0.6; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 2px;">Rare Root</div>
            <h2>${product.name}</h2>
            <div class="modal-price">${priceDisplay}</div>
            
            <div class="modal-description">
                ${product.description || "Premium quality fabric, designed for the disciplined. Built for movement and style."}
            </div>
            
            <div class="modal-opt-group">
                <label class="modal-opt-label">Select Size</label>
                <select id="modal-size" class="modal-select">
                    ${sizeOptions}
                </select>
            </div>
            
            <div class="modal-opt-group">
                <label class="modal-opt-label">Select Variant</label>
                <select id="modal-color" class="modal-select" onchange="onColorChange(this)">
                    ${colorOptions}
                </select>
            </div>

            ${isOut 
                ? `<button class="btn-add-modal" disabled style="opacity:0.6; pointer-events:none;">Out of Stock</button>` 
                : `<button class="btn-add-modal" onclick="addToCartFromModal()">Add to Bag - ₦${actualPrice.toLocaleString()}</button>`}
        </div>
    `;

    initSwipe(variants);
    modal.style.display = "block";
    document.body.style.overflow = 'hidden';
}

function initSwipe(variants) {
    const container = document.getElementById('modal-swipe-container');
    if (!container || variants.length <= 1) return;

    let startX = 0;
    let currentIndex = 0;

    container.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
    }, {passive: true});

    container.addEventListener('touchend', (e) => {
        const endX = e.changedTouches[0].clientX;
        const diff = startX - endX;

        if (Math.abs(diff) > 50) {
            if (diff > 0) {
                currentIndex = (currentIndex + 1) % variants.length;
            } else {
                currentIndex = (currentIndex - 1 + variants.length) % variants.length;
            }
            const v = variants[currentIndex];
            updateModalImage(v.image, v.color, document.querySelectorAll('.thumb-img')[currentIndex]);
        }
    }, {passive: true});
}

function updateModalImage(src, color, thumbEl) {
    const img = document.getElementById('modal-main-img');
    if(img) {
        img.style.opacity = '0.5';
        setTimeout(() => {
            img.src = src;
            img.style.opacity = '1';
        }, 200);
    }
    
    if (color) {
        const select = document.getElementById('modal-color');
        if (select) select.value = color;
    }

    if (thumbEl) {
        document.querySelectorAll('.thumb-img').forEach(el => el.classList.remove('active'));
        thumbEl.classList.add('active');
    }
}

function onColorChange(select) {
    const selectedOption = select.options[select.selectedIndex];
    const imgSrc = selectedOption.getAttribute('data-img');
    const color = select.value;
    
    if (imgSrc) {
        const img = document.getElementById('modal-main-img');
        if(img) img.src = imgSrc;
        
        const thumbnails = document.querySelectorAll('.thumb-img');
        thumbnails.forEach(thumb => {
            if (thumb.getAttribute('alt') === color) {
                thumb.classList.add('active');
            } else {
                thumb.classList.remove('active');
            }
        });
    }
}

function closeModal() {
    document.getElementById('product-modal').style.display = "none";
    document.body.style.overflow = '';
    currentModalProduct = null;
}

// ------------------------------------------------
// 4. SIZE GUIDE MODAL
// ------------------------------------------------
function openSizeGuide() {
    pushModalState('size-guide');
    document.getElementById('size-guide-modal').style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeSizeGuide() {
    document.getElementById('size-guide-modal').style.display = 'none';
    document.body.style.overflow = '';
}

function showSizeTab(tab) {
    currentSizeTab = tab;
    
    // Update tab buttons
    document.querySelectorAll('.size-tab').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Show corresponding content
    document.querySelectorAll('.size-tab-content').forEach(content => {
        content.style.display = 'none';
    });
    document.getElementById('size-' + tab).style.display = 'block';
}

// ------------------------------------------------
// 5. SHIPPING MODAL
// ------------------------------------------------
function openShippingModal() {
    pushModalState('shipping');
    document.getElementById('shipping-modal').style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeShippingModal() {
    document.getElementById('shipping-modal').style.display = 'none';
    document.body.style.overflow = '';
}

// ------------------------------------------------
// 6. TRACK ORDER MODAL
// ------------------------------------------------
function openTrackModal() {
    pushModalState('track');
    document.getElementById('track-modal').style.display = "block";
    document.body.style.overflow = 'hidden';
}

function closeTrackModal() {
    document.getElementById('track-modal').style.display = "none";
    document.body.style.overflow = '';
}

async function findOrder() {
    try {
        initFirebase();
        const code = (document.getElementById('track-code').value || '').trim();
        const ref = (document.getElementById('track-ref').value || '').trim();
        const resultEl = document.getElementById('track-result');
        resultEl.innerHTML = '<p style="opacity:0.6;">Searching...</p>';
        let q;
        if (code) {
            q = await db.collection('orders').where('trackingCode', '==', code).limit(1).get();
        } else if (ref) {
            q = await db.collection('orders').where('reference', '==', ref).limit(1).get();
        } else {
            resultEl.innerHTML = '<p style="opacity:0.6;">Enter tracking code or reference.</p>';
            return;
        }
        if (q.empty) {
            resultEl.innerHTML = '<p style="opacity:0.6;">No order found. Check your code/reference.</p>';
            return;
        }
        const doc = q.docs[0];
        const o = { id: doc.id, ...doc.data() };
        const itemsList = (o.items || []).map(i => `${i.name} • ${i.size}/${i.color} x${i.qty || 1}`).join('<br>');
        resultEl.innerHTML = `
            <div class="glass-card" style="padding:15px;">
                <div style="font-weight:bold; color:var(--text-gold);">Status: ${o.status || 'paid'}</div>
                <div style="margin-top:8px; font-size:0.9rem; opacity:0.8;">Total: ₦${(o.total || 0).toLocaleString()}</div>
                ${o.trackingCode ? `<div style="margin-top:8px;">Tracking Code: <strong>${o.trackingCode}</strong></div>` : ''}
                <div style="margin-top:8px; font-size:0.85rem; opacity:0.8;">Items:<br>${itemsList}</div>
            </div>
        `;
    } catch (e) {
        console.error(e);
        showToast('Failed to track order. Try again.');
    }
}

// ------------------------------------------------
// 7. NAVIGATION HISTORY (BACK BUTTON SUPPORT)
// ------------------------------------------------
function pushModalState(modalType) {
    if (!isNavigatingBack) {
        navigationHistory.push({ type: modalType });
        history.pushState({ modal: modalType }, '', window.location.href);
    }
    isNavigatingBack = false;
}

function goToHome() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
    return false;
}

// Handle browser back button
window.addEventListener('popstate', function(event) {
    isNavigatingBack = true;
    
    // Close all modals
    closeModal();
    closeTrackModal();
    closeSizeGuide();
    closeShippingModal();
    closeAllDrawers();
    
    // Remove last history entry
    if (navigationHistory.length > 0) {
        navigationHistory.pop();
    }
});

// Close modal when clicking outside
window.onclick = function(event) {
    const modals = ['product-modal', 'track-modal', 'size-guide-modal', 'shipping-modal'];
    modals.forEach(modalId => {
        const modal = document.getElementById(modalId);
        if (event.target === modal) {
            if (modalId === 'product-modal') closeModal();
            else if (modalId === 'track-modal') closeTrackModal();
            else if (modalId === 'size-guide-modal') closeSizeGuide();
            else if (modalId === 'shipping-modal') closeShippingModal();
        }
    });
}

// ------------------------------------------------
// 8. CART LOGIC
// ------------------------------------------------
function addToCartFromModal() {
    if (!currentModalProduct) return;

    const size = document.getElementById('modal-size').value;
    const colorSelect = document.getElementById('modal-color');
    const color = colorSelect.value;
    const selectedOption = colorSelect.options[colorSelect.selectedIndex];
    const variantImg = selectedOption.getAttribute('data-img');

    const price = currentModalProduct.sale_price || currentModalProduct.price;

    const existingItem = cart.find(item => 
        item.id === currentModalProduct.id && 
        item.selectedSize === size && 
        item.selectedColor === color
    );

    if (existingItem) {
        existingItem.quantity = (existingItem.quantity || 1) + 1;
    } else {
        const cartItem = {
            ...currentModalProduct,
            img: variantImg || currentModalProduct.img,
            selectedSize: size,
            selectedColor: color,
            finalPrice: price,
            quantity: 1,
            cartId: Date.now()
        };
        cart.push(cartItem);
    }

    updateCartUI();
    saveCart();
    closeModal();
    showToast(`Added ${currentModalProduct.name} to bag`);
    toggleCart();
}

function updateCartUI() {
    const cartItemsContainer = document.getElementById('cart-items');
    const cartCount = document.getElementById('cart-count');
    const cartTotal = document.getElementById('cart-total');

    const totalQty = cart.reduce((acc, item) => acc + (item.quantity || 1), 0);
    cartCount.innerText = totalQty;

    cartItemsContainer.innerHTML = '';
    let total = 0;

    if (cart.length === 0) {
        cartItemsContainer.innerHTML = `
            <div class="empty-cart">
                <img src="https://files.fm/thumb.php?i=4wunrd26s5" alt="RARE ROOT">
                <p style="opacity: 0.6; margin-top: 10px;">Your bag is empty</p>
                <button class="btn-checkout" style="margin-top: 1.5rem;" onclick="toggleCart()">START SHOPPING</button>
            </div>
        `;
    } else {
        cart.forEach((item) => {
            const itemTotal = item.finalPrice * (item.quantity || 1);
            total += itemTotal;
            
            const itemDiv = document.createElement('div');
            itemDiv.className = 'cart-item';
            itemDiv.innerHTML = `
                <img src="${item.img}" alt="${item.name}">
                <div class="cart-item-info">
                    <div class="cart-item-name">${item.name}</div>
                    <div class="cart-item-meta">${item.selectedSize} | ${item.selectedColor}</div>
                    <div class="cart-item-price">₦${item.finalPrice.toLocaleString()}</div>
                    <div class="cart-item-qty">
                        <button class="qty-btn" onclick="updateQty(${item.cartId}, -1)">-</button>
                        <span>${item.quantity || 1}</span>
                        <button class="qty-btn" onclick="updateQty(${item.cartId}, 1)">+</button>
                    </div>
                </div>
                <div class="cart-item-remove" onclick="removeFromCart(${item.cartId})">
                    <i class="fas fa-times"></i>
                </div>
            `;
            cartItemsContainer.appendChild(itemDiv);
        });
    }

    cartTotal.innerText = '₦' + total.toLocaleString();
}

function updateQty(cartId, delta) {
    const item = cart.find(i => i.cartId === cartId);
    if (item) {
        item.quantity = (item.quantity || 1) + delta;
        if (item.quantity <= 0) {
            removeFromCart(cartId);
        } else {
            updateCartUI();
            saveCart();
        }
    }
}

function removeFromCart(cartId) {
    cart = cart.filter(item => item.cartId !== cartId);
    updateCartUI();
    saveCart();
}

function toggleCart() {
    const drawer = document.getElementById('cart-drawer');
    const overlay = document.getElementById('overlay');
    
    if (drawer.classList.contains('open')) {
        drawer.classList.remove('open');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
    } else {
        document.getElementById('menu-drawer').classList.remove('open');
        drawer.classList.add('open');
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function toggleMenu() {
    const drawer = document.getElementById('menu-drawer');
    const overlay = document.getElementById('overlay');
    
    if (drawer.classList.contains('open')) {
        drawer.classList.remove('open');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
    } else {
        document.getElementById('cart-drawer').classList.remove('open');
        drawer.classList.add('open');
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function closeAllDrawers() {
    document.getElementById('menu-drawer').classList.remove('open');
    document.getElementById('cart-drawer').classList.remove('open');
    document.getElementById('overlay').classList.remove('active');
    document.body.style.overflow = '';
}

// ------------------------------------------------
// 9. CHECKOUT
// ------------------------------------------------
function checkoutPaystack() {
    if (cart.length === 0) {
        showToast("Your bag is empty!");
        return;
    }
    const emailInput = document.getElementById('checkout-email');
    const email = emailInput ? emailInput.value.trim() : '';
    if (!email || !email.includes('@')) {
        showToast("Email is required for payment.");
        return;
    }
    const totalAmount = cart.reduce((sum, item) => sum + item.finalPrice * (item.quantity || 1), 0);
    try {
        const handler = PaystackPop.setup({
            key: PAYSTACK_PUBLIC_KEY,
            email: email,
            amount: Math.round(totalAmount * 100),
            currency: 'NGN',
            ref: 'RR-' + Date.now(),
            metadata: {
                cart: cart.map(i => ({
                    id: i.id,
                    name: i.name,
                    size: i.selectedSize,
                    color: i.selectedColor,
                    qty: i.quantity || 1,
                    unit_price: i.finalPrice
                })),
                total: totalAmount
            },
            callback: function (response) {
                showToast("Payment successful. Ref: " + response.reference);
                recordOrder(email, totalAmount, response.reference);
                cart = [];
                updateCartUI();
                toggleCart();
                saveCart();
                try { localStorage.setItem('rr_email', email); } catch (e) {}
            },
            onClose: function () {
                showToast("Payment window closed.");
            }
        });
        handler.openIframe();
    } catch (e) {
        console.error(e);
        alert("Unable to initialize Paystack. Please ensure the public key is set.");
    }
}

function recordOrder(email, totalAmount, reference) {
    try {
        initFirebase();
        const order = {
            email,
            total: totalAmount,
            reference,
            status: 'paid',
            items: cart.map(i => ({
                id: i.id,
                name: i.name,
                size: i.selectedSize,
                color: i.selectedColor,
                qty: i.quantity || 1,
                unit_price: i.finalPrice
            })),
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        db.collection('orders').add(order).then(() => {
            console.log('Order recorded');
        }).catch(err => {
            console.error('Failed to record order', err);
        });
    } catch (err) {
        console.error('Record order error', err);
    }
}

// ------------------------------------------------
// 10. SEARCH LOGIC
// ------------------------------------------------
function handleSearch(query) {
    const term = query.toLowerCase();
    
    if (!term) {
        document.querySelectorAll('.collection-header').forEach(el => el.style.display = 'block');
        const resultsHeader = document.getElementById('search-results-header');
        if (resultsHeader) resultsHeader.style.display = 'none';
        initializeShop();
        return;
    }

    const matches = products.filter(p => 
        !p.hidden && (
            p.name.toLowerCase().includes(term) || 
            p.category.toLowerCase().includes(term) ||
             (p.tags && p.tags.some(tag => (typeof tag === 'string' ? tag : tag.tag || '').toLowerCase().includes(term))) ||
             (p.description && p.description.toLowerCase().includes(term))
         )
    );

    document.getElementById('exchange-grid').innerHTML = '';
    document.getElementById('kinetic-grid').innerHTML = '';
    document.getElementById('urban-grid').innerHTML = '';
    
    document.querySelectorAll('.collection-header').forEach(el => el.style.display = 'none');
    
    let resultsHeader = document.getElementById('search-results-header');
    if (!resultsHeader) {
        resultsHeader = document.createElement('div');
        resultsHeader.id = 'search-results-header';
        resultsHeader.className = 'collection-header';
        resultsHeader.innerHTML = '<h2 class="category-title">Search Results</h2>';
        document.getElementById('exchange-grid').parentNode.insertBefore(resultsHeader, document.getElementById('exchange-grid'));
    }
    resultsHeader.style.display = 'block';

    if (matches.length === 0) {
        document.getElementById('exchange-grid').innerHTML = '<p style="text-align:center; padding:40px; opacity: 0.6;">No products found.</p>';
    } else {
        const container = document.getElementById('exchange-grid');
        matches.forEach(product => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.onclick = () => openProductModal(product.id);
            
            const isSale = product.sale_price && product.sale_price < product.price;
            const priceDisplay = isSale 
                ? `<span class="original-price">₦${product.price.toLocaleString()}</span> <span class="price">₦${product.sale_price.toLocaleString()}</span>` 
                : `<span class="price">₦${product.price.toLocaleString()}</span>`;
            
            const discountBadge = isSale 
                ? `<span class="discount-badge">-${Math.round(((product.price - product.sale_price) / product.price) * 100)}%</span>` 
                : '';

            card.innerHTML = `
                <div class="product-image-container">
                    ${discountBadge}
                    <img src="${product.img}" alt="${product.name}" loading="lazy">
                    <button class="view-options-btn">
                        <i class="fas fa-shopping-cart"></i> VIEW
                    </button>
                </div>
                <div class="product-info">
                    <h3>${product.name}</h3>
                    <p class="price">${priceDisplay}</p>
                </div>
            `;
            container.appendChild(card);
        });
    }
}

// ------------------------------------------------
// 11. UTILITIES
// ------------------------------------------------
function showToast(message) {
    const toast = document.getElementById("toast");
    if (!toast) return;
    toast.innerText = message;
    toast.className = "toast show";
    setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
}

// ------------------------------------------------
// INITIALIZATION
// ------------------------------------------------
document.addEventListener('DOMContentLoaded', () => {
    loadCart();
    fetchProducts();
    
    const savedEmail = (() => { 
        try { return localStorage.getItem('rr_email') || ''; } catch (e) { return ''; } 
    })();
    const emailInput = document.getElementById('checkout-email');
    if (emailInput && savedEmail) { emailInput.value = savedEmail; }
    
    // Initialize history state
    history.replaceState({ page: 'home' }, '', window.location.href);
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeModal();
        closeTrackModal();
        closeSizeGuide();
        closeShippingModal();
        closeAllDrawers();
    }
});
    </script>
</body>
</html>
